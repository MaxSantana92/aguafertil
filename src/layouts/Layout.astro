---
import '../styles/global.css';
import Navigation from '../components/Navigation.astro';
import Footer from '../components/Footer.astro';

interface Props {
	title?: string;
	description?: string;
	lang?: string;
}

const {
	title = 'Agua Fertil - Nutrición Vegetal Sustentable',
	description = 'Distribuimos tecnología Simbios en San Juan y La Rioja. Tecnologías sustentables para el agro basadas en bio y nanopartículas.',
	lang = 'es'
} = Astro.props;
---

<!doctype html>
<html lang={lang}>
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="icon" type="image/svg+xml" href={`${import.meta.env.BASE_URL}/favicon.svg`} />
		<meta name="generator" content={Astro.generator} />
		<meta name="description" content={description} />

		<title>{title}</title>

		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
	</head>
	<body class="antialiased">
		<Navigation />
		<main>
			<slot />
		</main>
		<Footer />

    <button
      id="scroll-to-top"
      class="fixed bottom-8 right-8 w-12 h-12 theme-blue-only text-white rounded-full shadow-lg hover:shadow-xl transition-all hover:scale-110 opacity-0 pointer-events-none z-40"
      aria-label="Scroll to top"
    >
			<svg class="w-6 h-6 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
				<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path>
			</svg>
		</button>
	</body>
</html>

<style>
	html {
		font-family: 'Montserrat', system-ui, -apple-system, sans-serif;
		scroll-behavior: smooth;
	}

	body {
		margin: 0;
		padding: 0;
		background: white;
	}

	.theme-gradient {
		background: linear-gradient(to bottom right, var(--theme-gradient-from), var(--theme-gradient-to));
	}
</style>

<script>
	const scrollButton = document.getElementById('scroll-to-top');

	window.addEventListener('scroll', () => {
		if (window.scrollY > 500) {
			scrollButton?.classList.remove('opacity-0', 'pointer-events-none');
		} else {
			scrollButton?.classList.add('opacity-0', 'pointer-events-none');
		}
	});

	scrollButton?.addEventListener('click', () => {
		window.scrollTo({
			top: 0,
			behavior: 'smooth'
		});
	});

	const lazySections = Array.from(document.querySelectorAll('.lazy-section'));
	const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

	if (!('IntersectionObserver' in window) || prefersReducedMotion) {
		lazySections.forEach((section) => section.classList.add('is-visible'));
	} else if (lazySections.length > 0) {
		const observer = new IntersectionObserver(
			(entries, obs) => {
				entries.forEach((entry) => {
					if (entry.isIntersecting) {
						entry.target.classList.add('is-visible');
						obs.unobserve(entry.target);
					}
				});
			},
			{
				rootMargin: '0px 0px -10% 0px',
				threshold: 0.15
			}
		);

		lazySections.forEach((section) => observer.observe(section));
	}
</script>
