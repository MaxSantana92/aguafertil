---
import { getLangFromUrl, useTranslations } from '../i18n/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const faqs = [
  {
    question: '¿Qué tecnologías ofrecen?',
    questionEn: 'What technologies do you offer?',
    answer: 'Ofrecemos una amplia gama de tecnologías: materia orgánica, biofertilizantes, bioestimulantes foliares, microorganismos, nanopartículas y correctores de suelo. Todas basadas en tecnología sustentable.',
    answerEn: 'We offer a wide range of technologies: organic matter, biofertilizers, foliar biostimulants, microorganisms, nanoparticles and soil correctors. All based on sustainable technology.'
  },
  {
    question: '¿Ofrecen asesoramiento técnico?',
    questionEn: 'Do you offer technical advice?',
    answer: 'Sí, contamos con profesionales especializados que brindan asesoramiento personalizado en cada etapa del cultivo, desde la selección de tecnologías hasta la aplicación.',
    answerEn: 'Yes, we have specialized professionals who provide personalized advice at each stage of cultivation, from technology selection to application.'
  },
  {
    question: '¿En qué zonas trabajan?',
    questionEn: 'What areas do you work in?',
    answer: 'Trabajamos principalmente en San Juan y La Rioja, ofreciendo cobertura completa en toda la región para distribución, asesoramiento y soporte técnico.',
    answerEn: 'We work mainly in San Juan and La Rioja, offering complete coverage throughout the region for distribution, advice and technical support.'
  },
  {
    question: '¿Prestan maquinaria?',
    questionEn: 'Do you lend machinery?',
    answer: 'Sí, ofrecemos préstamo de maquinaria especializada para la aplicación de nuestras tecnologías, facilitando el trabajo de los productores.',
    answerEn: 'Yes, we offer specialized machinery loans for the application of our technologies, making it easier for producers to work.'
  },
  {
    question: '¿Las tecnologías son certificadas orgánicas?',
    questionEn: 'Are the technologies certified organic?',
    answer: 'Contamos con tecnologías orgánicas certificadas y también con soluciones basadas en biotecnología y nanopartículas que respetan el medio ambiente.',
    answerEn: 'We have certified organic technologies and also solutions based on biotechnology and nanoparticles that respect the environment.'
  },
  {
    question: '¿Cómo puedo hacer un pedido?',
    questionEn: 'How can I place an order?',
    answer: 'Puedes contactarnos a través del formulario de esta web, por teléfono, email o visitándonos directamente. Nuestro equipo te asesorará sobre las tecnologías más adecuadas para tu cultivo.',
    answerEn: 'You can contact us through the form on this website, by phone, email or by visiting us directly. Our team will advise you on the most suitable technologies for your crop.'
  }
];
---

<section class="bg-gradient-to-br from-gray-50 to-white w-full">
  <div class="container mx-auto px-4">
    <div class="text-center mb-16">
      <h2 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">{t('faq.title')}</h2>
      <p class="text-xl text-gray-600">{t('faq.subtitle')}</p>
    </div>

    <div class="max-w-3xl mx-auto space-y-4">
      {faqs.map((faq, index) => (
        <div class="faq-item bg-white rounded-2xl shadow-md overflow-hidden" style={`animation-delay: ${index * 0.1}s`}>
          <button
            class="faq-question w-full text-left p-6 flex items-center justify-between hover:bg-emerald-50 transition-colors"
            data-faq={index}
          >
            <span class="text-lg font-semibold text-gray-900 pr-4">
              {lang === 'es' ? faq.question : faq.questionEn}
            </span>
            <svg class="faq-icon w-6 h-6 text-emerald-600 flex-shrink-0 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>
          <div class="faq-answer hidden px-6 pb-6">
            <p class="text-gray-600 leading-relaxed">
              {lang === 'es' ? faq.answer : faq.answerEn}
            </p>
          </div>
        </div>
      ))}
    </div>
  </div>
</section>

<style>
  .faq-item {
    animation: fadeInUp 0.6s ease-out;
    animation-fill-mode: both;
  }

  .faq-answer {
    max-height: 0;
    transition: max-height 0.3s ease-out;
  }

  .faq-answer.open {
    max-height: 500px;
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>

<script>
  const faqButtons = document.querySelectorAll('.faq-question');

  faqButtons.forEach(button => {
    button.addEventListener('click', () => {
      const answer = button.nextElementSibling as HTMLElement;
      const icon = button.querySelector('.faq-icon') as HTMLElement;
      const isOpen = answer.classList.contains('open');

      document.querySelectorAll<HTMLElement>('.faq-answer').forEach(item => {
        item.classList.remove('open');
        item.classList.add('hidden');
      });

      document.querySelectorAll<HTMLElement>('.faq-icon').forEach(item => {
        item.style.transform = 'rotate(0deg)';
      });

      if (!isOpen) {
        answer.classList.remove('hidden');
        setTimeout(() => {
          answer.classList.add('open');
        }, 10);
        icon.style.transform = 'rotate(180deg)';
      }
    });
  });
</script>
