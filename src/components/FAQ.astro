---
import { getLangFromUrl, useTranslations } from '../i18n/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const faqs = [
  {
    question: t('faq.questions.1.question'),
    answer: t('faq.questions.1.answer')
  },
  {
    question: t('faq.questions.2.question'),
    answer: t('faq.questions.2.answer')
  },
  {
    question: t('faq.questions.3.question'),
    answer: t('faq.questions.3.answer')
  },
  {
    question: t('faq.questions.4.question'),
    answer: t('faq.questions.4.answer')
  },
  {
    question: t('faq.questions.5.question'),
    answer: t('faq.questions.5.answer')
  },
  {
    question: t('faq.questions.6.question'),
    answer: t('faq.questions.6.answer')
  }
];
---

<section class="bg-gradient-to-br from-gray-50 to-white w-full py-16 md:py-20 lg:py-24">
  <div class="container mx-auto px-4">
    <div class="text-center mb-16">
      <h2 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">{t('faq.title')}</h2>
      <p class="text-xl text-gray-600 text-gray-900 font-medium">{t('faq.subtitle')}</p>
    </div>

    <div class="max-w-3xl mx-auto space-y-4">
      {faqs.map((faq, index) => (
        <div class="faq-item bg-white rounded-2xl shadow-md overflow-hidden" style={`animation-delay: ${index * 0.1}s`}>
          <button
            class="faq-question w-full text-left p-6 flex items-center justify-between hover:bg-emerald-50 transition-colors"
            data-faq={index}
          >
            <span class="text-lg font-semibold text-gray-900 pr-4">
              {faq.question}
            </span>
            <svg class="faq-icon w-6 h-6 text-emerald-600 flex-shrink-0 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>
          <div class="faq-answer hidden px-6 pb-6">
            <p class="text-gray-600 leading-relaxed text-gray-900 font-medium">
              {faq.answer}
            </p>
          </div>
        </div>
      ))}
    </div>
  </div>
</section>

<style>
  .faq-item {
    animation: fadeInUp 0.6s ease-out;
    animation-fill-mode: both;
  }

  .faq-answer {
    max-height: 0;
    transition: max-height 0.3s ease-out;
  }

  .faq-answer.open {
    max-height: 500px;
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>

<script>
  const faqButtons = document.querySelectorAll('.faq-question');

  faqButtons.forEach(button => {
    button.addEventListener('click', () => {
      const answer = button.nextElementSibling as HTMLElement;
      const icon = button.querySelector('.faq-icon') as HTMLElement;
      const isOpen = answer.classList.contains('open');

      document.querySelectorAll<HTMLElement>('.faq-answer').forEach(item => {
        item.classList.remove('open');
        item.classList.add('hidden');
      });

      document.querySelectorAll<HTMLElement>('.faq-icon').forEach(item => {
        item.style.transform = 'rotate(0deg)';
      });

      if (!isOpen) {
        answer.classList.remove('hidden');
        setTimeout(() => {
          answer.classList.add('open');
        }, 10);
        icon.style.transform = 'rotate(180deg)';
      }
    });
  });
</script>
